(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{20:function(e,t,n){e.exports=n(36)},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(5),i=n.n(c),s=n(9),o=n(10),u=n(2),l=n.n(u),m=n(3),f=n(8),d=new function e(){var t=this;Object(f.a)(this,e),this.baseUrl="https://starnavi-frontend-test-task.herokuapp.com/",this.fetchData=function(){var e=Object(m.a)(l.a.mark((function e(n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t.baseUrl).concat(n));case 2:if((a=e.sent).ok){e.next=5;break}throw new Error("Could not fetch ".concat(n)+", received ".concat(a.status));case 5:return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.postData=function(){var e=Object(m.a)(l.a.mark((function e(n){var a,r,c=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:{},e.next=3,fetch("".concat(t.baseUrl).concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getGameSettings=Object(m.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchData("game-settings");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.getWinners=Object(m.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchData("winners");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),this.setWinner=function(){var e=Object(m.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.postData("winners",n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=function(e){return function(){e({type:"GAME_SETTINGS_REQUEST"}),d.getGameSettings().then((function(t){e({type:"GAME_SETTINGS_SUCCESS",payload:t})})).catch((function(e){return console.log(e)}))}},p=function(e){return{type:"WINNERS_SUCCESS",payload:e}},E=function(e){return function(){var t=function(){e({type:"WINNERS_REQUEST"}),d.getWinners().then((function(t){e(p(t))})).catch((function(e){return console.log(e)}))};t(),setInterval((function(){t()}),3e4)}},h=function(e){return{type:"STOP_GAME",payload:e}},v=function(e,t){return{type:"CHANGE_MODE",payload:{idx:e,mode:t}}},S=(n(32),function(e){var t=e.activeName,n=e.preparedSettings,c=e.onChange,i=Object(a.useState)(!1),s=Object(o.a)(i,2),u=s[0],l=s[1];return r.a.createElement("div",{className:"game_select ".concat(u?"open":"")},r.a.createElement("div",{className:"current",onClick:function(){return l(!u)}},t||"Pick game mode"),r.a.createElement("div",{className:"game_options"},n.map((function(e){return r.a.createElement("div",{key:e[0],onClick:function(){return t=e[0],c(t),void l(!1);var t}},e[1].delay," , ",e[0])}))))}),y=(n(33),function(){return r.a.createElement("div",{className:"loader"})}),b=Object(s.b)((function(e){return{name:e.name,winners:e.winners,gameSettings:e.gameSettings,game:e.game}}),(function(e){return{fetchGameSettings:g(e),fetchWinners:E(e),changeName:function(t){return e({type:"CHANGE_NAME",payload:t})},changeMode:function(t,n){return e(v(t,n))},startGame:function(){return e({type:"START_GAME"})},setRandomFieldTimeout:function(t,n){return function(e,t,n){if(n.filter((function(e){return"comp"===e})).length>n.length/2)e(h("comp"));else if(n.filter((function(e){return"human"===e})).length>n.length/2)e(h("human"));else{for(var a=Math.floor(Math.random()*n.length);"free"!==n[a];)a=Math.floor(Math.random()*n.length);e(v(a,"active")),setTimeout((function(){e(v(a,"comp"))}),t.delay)}}(e,t,n)},selectSettings:function(t){return e(function(e){return{type:"SELECT_SETTINGS",payload:e}}(t))},sendWinner:function(t){return function(e,t){var n=new Date,a=new Intl.DateTimeFormat("en",{year:"numeric",month:"short",day:"2-digit"}).formatToParts(n),r=Object(o.a)(a,5),c=r[0].value,i=r[2].value,s=r[4].value;e({type:"WINNERS_REQUEST"}),d.setWinner({winner:t,date:"".concat(n.getHours(),":").concat(n.getMinutes(),"; ").concat(i," ").concat(c," ").concat(s)}).then((function(t){e(p(t))})).catch((function(e){return console.log(e)}))}(e,t)}}}))((function(e){var t=e.name,n=e.winners,c=e.gameSettings,i=e.game,s=e.fetchGameSettings,o=e.fetchWinners,u=e.changeName,l=e.setRandomFieldTimeout,m=e.changeMode,f=e.startGame,d=e.selectSettings,g=e.sendWinner;Object(a.useEffect)((function(){s(),o()}),[]),Object(a.useEffect)((function(){var e=-1!==i.fields.findIndex((function(e){return"active"===e}));i.isGoing&&!e&&l(c.active,i.fields)}),[i.fields]);var p=Object.keys(c.values).map((function(e){return[e,c.values[e]]}));return Object(a.useEffect)((function(){if(i.gamesPlayed>0){var e=t||"No Name",n="human"===i.winner?e:"Computer";g(n)}}),[i.gamesPlayed]),r.a.createElement("div",{className:"game_wrapper"},r.a.createElement("div",{className:"left_side"},r.a.createElement("div",{className:"menu"},c.isLoading&&r.a.createElement(y,null),r.a.createElement(S,{activeName:c.active.name,preparedSettings:p,onChange:d}),r.a.createElement("input",{value:t,onChange:function(e){return u(e.currentTarget.value)},placeholder:"Enter your name"}),r.a.createElement("button",{onClick:function(){return f()},disabled:i.isGoing||!c.active.name},i.gamesPlayed>0?"Play again":"Start Game")),r.a.createElement("div",{className:"message"},"human"===i.winner&&"Winner: ".concat(t||"No Name"),"comp"===i.winner&&"Winner: Computer"),r.a.createElement("div",{className:"game_fields"},i.fields.map((function(e,t){var n=null;return t%c.active.field===0&&(n=r.a.createElement("div",{className:"break"})),r.a.createElement(r.a.Fragment,{key:t},n,r.a.createElement("div",{className:"field ".concat(e),onClick:function(){return m(t,"human")}}))})))),r.a.createElement("div",{className:"right_side"},r.a.createElement("div",{className:"winner_wrapper"},r.a.createElement("div",{className:"winner_head"},"Leader Board"),r.a.createElement("div",{className:"winners"},n.isLoading&&r.a.createElement(y,null),n.values.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("span",null,e.winner)," ",r.a.createElement("span",null,e.date))}))))))})),N=(n(34),function(){return r.a.createElement("div",{className:"main"},r.a.createElement(b,null))}),O=n(16),w=n(17),j=n(19),T=(n(35),function(){return r.a.createElement("div",null,"Error!")}),G=function(e){Object(j.a)(n,e);var t=Object(w.a)(n);function n(){var e;Object(f.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={hasError:!1},e}return Object(O.a)(n,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(T,null):this.props.children}}]),n}(a.Component),_=n(6),C=n(18),k=n(1),M={name:"",winners:{values:[],isLoading:!1},gameSettings:{values:{},active:{},isLoading:!1},game:{fields:[],gamesPlayed:0,winner:"",isGoing:!1}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"START_GAME":return Object(k.a)({},e,{game:Object(k.a)({},e.game,{fields:Array.from(new Array(Math.pow(e.gameSettings.active.field,2)),(function(){return"free"})),isGoing:!0,winner:""})});case"CHANGE_MODE":if("active"!==e.game.fields[t.payload.idx]&&"active"!==t.payload.mode)return e;var n=Object(C.a)(e.game.fields);return n[t.payload.idx]=t.payload.mode,Object(k.a)({},e,{game:Object(k.a)({},e.game,{fields:n})});case"STOP_GAME":return Object(k.a)({},e,{game:Object(k.a)({},e.game,{gamesPlayed:e.game.gamesPlayed+1,isGoing:!1,winner:t.payload})});case"SELECT_SETTINGS":return Object(k.a)({},e,{gameSettings:Object(k.a)({},e.gameSettings,{active:Object(k.a)({},e.gameSettings.values[t.payload],{name:t.payload})}),game:Object(k.a)({},e.game,{fields:[],isGoing:!1})});case"GAME_SETTINGS_REQUEST":return Object(k.a)({},e,{gameSettings:Object(k.a)({},e.gameSettings,{isLoading:!0})});case"GAME_SETTINGS_SUCCESS":return Object(k.a)({},e,{gameSettings:Object(k.a)({},e.gameSettings,{values:t.payload,isLoading:!1})});case"WINNERS_REQUEST":return Object(k.a)({},e,{winners:Object(k.a)({},e.winners,{isLoading:!0})});case"WINNERS_SUCCESS":return Object(k.a)({},e,{winners:Object(k.a)({},e.winners,{values:t.payload.reverse().slice(0,30),isLoading:!1})});case"CHANGE_NAME":return Object(k.a)({},e,{name:t.payload});default:return e}},x=Object(_.b)(A);i.a.render(r.a.createElement(s.a,{store:x},r.a.createElement(G,null,r.a.createElement(N,null))),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.a1856187.chunk.js.map